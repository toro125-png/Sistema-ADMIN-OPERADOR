<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA INTEGRADO TUVN - CORE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Estilos Base Código 1 */
        :root {
            --neon-cyan: #00f2ff;
            --neon-purple: #bc13fe;
            --bg-dark: #020617;
            /* Estilos Base Código 2 */
            --neon-blue: #00d2ff;
            --neon-red: #ff0055;
            --neon-green: #39ff14;
            --panel-bg: rgba(10, 15, 28, 0.85);
        }

        body {
            background-color: var(--bg-dark);
            color: white;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            margin: 0;
        }

        .orbitron { font-family: 'Orbitron', sans-serif; }
        .tech-font { font-family: 'Orbitron', sans-serif; }

        /* Estructura de Pantallas */
        .screen {
            position: fixed;
            inset: 0;
            display: none;
            overflow-y: auto;
            z-index: 10;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Código 1: Home Styles */
        .bg-grid {
            position: fixed;
            top: 0; left: 0; width: 200%; height: 200%;
            background-image: 
                linear-gradient(rgba(0, 242, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 242, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            transform: rotateX(45deg) translateY(-20%);
            z-index: -1;
            animation: grid-move 20s linear infinite;
        }
        @keyframes grid-move {
            from { transform: rotateX(45deg) translateY(-50%); }
            to { transform: rotateX(45deg) translateY(0%); }
        }
        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 242, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.1);
        }
        .btn-3d { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform-style: preserve-3d; position: relative; }
        .btn-3d:hover { transform: translateY(-5px) rotateX(10deg); box-shadow: 0 15px 30px rgba(0, 242, 255, 0.3); border-color: var(--neon-cyan); }
        .hologram-text { text-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan); animation: flicker 3s infinite; }
        @keyframes flicker { 0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% { opacity: 1; } 20%, 22%, 24%, 55% { opacity: 0.5; } }

        /* Código 2: Panel Styles */
        .scifi-panel {
            background: var(--panel-bg);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 20px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }
        .scifi-panel::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
            animation: pulse-glow 2s infinite;
        }
        .panel-blue { --border-color: var(--neon-blue); box-shadow: 0 0 15px rgba(0, 210, 255, 0.1); }
        .panel-red { --border-color: var(--neon-red); box-shadow: 0 0 15px rgba(255, 0, 85, 0.1); }
        .panel-master { --border-color: var(--neon-green); border: 1px solid rgba(57, 255, 20, 0.2); }
        @keyframes pulse-glow { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
        .glass-inner { background: rgba(255, 255, 255, 0.03); border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.05); }
        .value-glow { text-shadow: 0 0 10px var(--border-color); }
        .scan-line {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, transparent 0%, rgba(57, 255, 20, 0.05) 50%, transparent 100%);
            background-size: 100% 4px;
            pointer-events: none;
            animation: scan 4s linear infinite;
        }
        @keyframes scan { from { transform: translateY(-100%); } to { transform: translateY(100%); } }
        canvas { max-height: 100px !important; }

        .thermal-bar {
            position: fixed;
            right: 20px; top: 50%; transform: translateY(-50%);
            width: 12px; height: 200px; border-radius: 20px;
            background: #1e293b; border: 1px solid rgba(255,255,255,0.1); z-index: 50;
        }
        .thermal-indicator { position: absolute; bottom: 0; width: 100%; border-radius: 20px; transition: all 0.5s ease; }

        /* Estilo para Deshabilitar Operario */
        .operario-mode .interactive-element {
            pointer-events: none !important;
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

    <div class="bg-grid"></div>

    <div id="homeScreen" class="screen active flex-col items-center justify-center">
        <div class="text-center mb-12">
            <h1 class="orbitron text-6xl font-black hologram-text mb-4 animate-pulse">BIENVENIDO AL SISTEMA</h1>
            <div class="h-1 w-64 bg-cyan-500 mx-auto rounded-full shadow-[0_0_15px_#00f2ff]"></div>
        </div>

        <div class="glass-panel p-8 rounded-xl border-t-4 border-t-cyan-500 mb-12 text-center w-full max-w-2xl">
            <h3 class="orbitron text-xs tracking-[0.4em] text-cyan-400 mb-6 uppercase">Core Development Unit</h3>
            <div class="flex justify-around items-center">
                <span class="dev-name font-bold text-xl">PILCO</span>
                <span class="w-2 h-2 bg-purple-500 rounded-full animate-ping"></span>
                <span class="dev-name font-bold text-xl">VELASCO</span>
                <span class="w-2 h-2 bg-purple-500 rounded-full animate-ping"></span>
                <span class="dev-name font-bold text-xl">TORO</span>
            </div>
        </div>

        <div class="flex gap-8">
            <button onclick="openAuth('ADMINISTRADOR')" class="btn-3d glass-panel px-12 py-6 rounded-lg group">
                <span class="orbitron text-xl font-bold tracking-widest group-hover:text-cyan-400 transition-colors">ADMINISTRADOR</span>
                <div class="absolute bottom-0 left-0 h-1 w-0 bg-cyan-500 group-hover:w-full transition-all duration-500"></div>
            </button>

            <button onclick="openAuth('OPERARIO')" class="btn-3d glass-panel px-12 py-6 rounded-lg group">
                <span class="orbitron text-xl font-bold tracking-widest group-hover:text-purple-400 transition-colors">OPERARIO</span>
                <div class="absolute bottom-0 left-0 h-1 w-0 bg-purple-500 group-hover:w-full transition-all duration-500"></div>
            </button>
        </div>
    </div>

    <div id="passwordModal" class="fixed inset-0 hidden z-[100] flex items-center justify-center backdrop-blur-xl">
        <div class="glass-panel p-10 rounded-2xl border-2 border-cyan-500/50 w-96 transform">
            <h2 id="modalTitle" class="orbitron text-2xl text-center mb-6 text-cyan-400">AUTENTICACIÓN</h2>
            <input type="password" id="passInput" placeholder="ENTER ACCESS KEY" 
                   class="w-full bg-slate-900 border border-cyan-500/30 p-4 rounded text-center orbitron tracking-widest focus:outline-none focus:border-cyan-400 mb-6">
            <div class="flex gap-4">
                <button onclick="closeAuth()" class="flex-1 py-2 hover:bg-red-500/20 transition-all rounded text-sm uppercase font-bold">Cancelar</button>
                <button onclick="verifyPass()" class="flex-1 py-2 bg-cyan-600 hover:bg-cyan-400 transition-all rounded text-sm uppercase font-bold text-black">Verificar</button>
            </div>
        </div>
    </div>

    <div id="mainPanel" class="screen flex-col">
        <div class="thermal-bar">
            <div id="thermalFill" class="thermal-indicator" style="height: 0%; background: var(--neon-blue);"></div>
            <div class="absolute -left-16 top-0 text-[10px] tech-font text-white/50">ESTADO</div>
        </div>

        <header class="relative border-b border-blue-500/30 bg-black/60 backdrop-blur-md w-full">
            <div class="container mx-auto px-6 py-4 flex flex-col md:flex-row justify-between items-center relative z-10">
                <div class="flex items-center gap-4">
                    <div class="bg-slate-900 p-2 rounded-lg border border-blue-400/50 relative">
                        <i data-lucide="shield-check" class="w-8 h-8 text-blue-400"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold tracking-tighter tech-font text-blue-400">TUVN <span class="text-white">CORE</span></h1>
                        <p id="roleLabel" class="text-[9px] text-blue-300/60 font-bold tracking-[0.4em] uppercase">Advanced Industrial Interface</p>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <button onclick="switchToOperator()" class="px-6 py-2 bg-purple-600/20 text-purple-500 border border-purple-500/50 rounded-full hover:bg-purple-600 hover:text-white transition-all text-xs font-bold tech-font">OPERARIO</button>
                    <button onclick="switchToAdmin()" class="px-6 py-2 bg-blue-600/20 text-blue-500 border border-blue-500/50 rounded-full hover:bg-blue-600 hover:text-white transition-all text-xs font-bold tech-font">ADMIN</button>
                    <button onclick="logout()" class="px-6 py-2 bg-red-600/20 text-red-500 border border-red-500/50 rounded-full hover:bg-red-600 hover:text-white transition-all text-xs font-bold tech-font">LOGOUT</button>
                </div>

                <div class="mt-4 md:mt-0 flex items-center gap-6 bg-slate-900/50 p-3 rounded-lg border border-white/5">
                    <div class="text-right">
                        <p id="dateDisplay" class="text-[9px] uppercase tracking-tighter opacity-50"></p>
                        <p id="timeDisplay" class="text-xl font-bold tech-font text-white">00:00:00</p>
                    </div>
                    <div class="flex flex-col items-center gap-1 border-l border-white/10 pl-4">
                        <div id="staticDot" class="h-2 w-2 rounded-full bg-red-600 shadow-[0_0_8px_#ef4444]"></div>
                        <span id="statusText" class="text-[9px] font-bold tech-font text-red-500">OFFLINE</span>
                    </div>
                </div>
            </div>
        </header>

        <main class="flex-grow container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="sensorContainer">
                </div>

            <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 scifi-panel panel-master p-6 bg-emerald-950/10 relative">
                    <div class="scan-line"></div>
                    <div class="flex flex-col md:flex-row items-center justify-between gap-6 relative z-10">
                        <div class="flex items-center gap-4">
                            <div class="p-4 rounded-full bg-emerald-500/10 border border-emerald-500/30 animate-pulse">
                                <i data-lucide="cpu" class="w-10 h-10 text-emerald-400"></i>
                            </div>
                            <div>
                                <h2 class="tech-font text-xl font-bold text-emerald-400">TEMPERATURA PROMEDIO</h2>
                                <p class="text-[10px] text-emerald-300/50 tracking-widest uppercase font-bold italic">Master System Summary</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-12">
                            <div class="text-center">
                                <span id="valAvg" class="text-7xl font-black tech-font text-emerald-400 value-glow" style="--border-color: var(--neon-green)">--</span>
                                <span class="text-2xl text-emerald-300 tech-font">°C</span>
                            </div>
                            <div class="hidden md:block w-64 glass-inner p-3">
                                <canvas id="chartAvg"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="scifi-panel panel-blue p-6 flex flex-col justify-center gap-4">
                    <h3 class="tech-font text-xs font-bold text-blue-400 mb-2 uppercase tracking-tighter">Control de Actuadores</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="sendCommand('AC1')" id="btnAC1" class="interactive-element glass-inner p-4 flex flex-col items-center gap-2 hover:bg-blue-500/20 transition-all border border-white/10">
                            <i data-lucide="fan" class="w-6 h-6 text-slate-400" id="iconAC1"></i>
                            <span class="tech-font text-[10px]">AC1</span>
                            <span id="statusAC1" class="text-[8px] font-bold text-slate-500">OFF</span>
                        </button>
                        <button onclick="sendCommand('AC2')" id="btnAC2" class="interactive-element glass-inner p-4 flex flex-col items-center gap-2 hover:bg-blue-500/20 transition-all border border-white/10">
                            <i data-lucide="wind" class="w-6 h-6 text-slate-400" id="iconAC2"></i>
                            <span class="tech-font text-[10px]">AC2</span>
                            <span id="statusAC2" class="text-[8px] font-bold text-slate-500">OFF</span>
                        </button>
                    </div>
                    <p id="modeText" class="text-[8px] tech-font text-center text-emerald-500/50 mt-2">MODO AUTOMÁTICO ACTIVO</p>
                </div>
            </div>

            <div class="mt-12 flex flex-col items-center">
                <button id="connectBtn" onclick="toggleConnection()" class="group relative px-10 py-4 bg-slate-900 text-white rounded-none overflow-hidden transition-all border border-blue-500/50 skew-x-[-15deg] hover:bg-blue-600/20">
                    <div class="relative flex items-center gap-3 tech-font font-bold skew-x-[15deg]">
                        <i data-lucide="bluetooth-connected" class="w-5 h-5 text-blue-400"></i>
                        <span id="btnText" class="tracking-[0.2em]">INICIAR PROTOCOLO</span>
                    </div>
                </button>
            </div>
        </main>

        <footer class="bg-black/80 py-4 text-center border-t border-white/5 backdrop-blur-sm w-full">
            <p class="text-[10px] text-slate-600 tracking-[0.5em]">IST VIDA NUEVA • INDUSTRIAL SYSTEMS © 2026</p>
        </footer>
    </div>

    <script>
        // --- LOGICA DE NAVEGACION (BASADA EN CODIGO 1) ---
        let currentUser = null;
        let targetRole = null;

        function openAuth(role) {
            targetRole = role;
            document.getElementById('modalTitle').innerText = `ACCESO ${role}`;
            document.getElementById('passwordModal').classList.remove('hidden');
            document.getElementById('passInput').focus();
        }

        function closeAuth() {
            document.getElementById('passwordModal').classList.add('hidden');
            document.getElementById('passInput').value = '';
        }

        function verifyPass() {
            const pass = document.getElementById('passInput').value.toUpperCase();
            if (pass === targetRole) {
                login(targetRole);
            } else {
                alert("ACCESO DENEGADO");
            }
        }

        function login(role) {
            currentUser = role;
            closeAuth();

            const mainPanel = document.getElementById('mainPanel');
            const homeScreen = document.getElementById('homeScreen');

            homeScreen.classList.remove('active');
            mainPanel.classList.add('active');

            if (role === 'ADMINISTRADOR') {
                mainPanel.classList.remove('operario-mode');
                document.getElementById('roleLabel').innerText = "ADMINISTRATOR CONTROL PANEL";
            } else {
                mainPanel.classList.add('operario-mode');
                document.getElementById('roleLabel').innerText = "OPERATOR VIEW ONLY";
            }
        }

        function logout() {
            if (bluetoothDevice && bluetoothDevice.gatt.connected) {
                bluetoothDevice.gatt.disconnect();
            }
            currentUser = null;
            document.getElementById('mainPanel').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
        }

        function switchToOperator() {
            currentUser = 'OPERARIO';
            mainPanel.classList.add('operario-mode');
            document.getElementById('roleLabel').innerText = "OPERATOR VIEW ONLY";
        }

        function switchToAdmin() {
            const password = prompt("Ingrese la contraseña de administrador:");
            if (password === 'ADMINISTRADOR') {
                currentUser = 'ADMINISTRADOR';
                mainPanel.classList.remove('operario-mode');
                document.getElementById('roleLabel').innerText = "ADMINISTRATOR CONTROL PANEL";
            } else {
                alert("Contraseña incorrecta.");
            }
        }

        document.getElementById('passInput').addEventListener('keypress', (e) => { if (e.key === 'Enter') verifyPass(); });

        // --- LÓGICA DE INSTRUMENTACIÓN (CÓDIGO 2 INTACTO) ---
        lucide.createIcons();
        const sensors = [
            { id: 1, label: 'SECTOR ALPHA-1', color: 'blue' },
            { id: 2, label: 'SECTOR ALPHA-2', color: 'red' },
            { id: 3, label: 'SECTOR ALPHA-3', color: 'blue' },
            { id: 4, label: 'SECTOR ALPHA-4', color: 'red' }
        ];

        // Generar HTML de Sensores
        const container = document.getElementById('sensorContainer');
        sensors.forEach(s => {
            container.innerHTML += `
                <div class="scifi-panel panel-${s.color} p-4 group">
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex flex-col">
                            <span class="text-[10px] text-white/40 tech-font tracking-widest uppercase">Sensor Node</span>
                            <span class="tech-font text-xs font-bold text-white">${s.label}</span>
                        </div>
                        <div class="p-2 glass-inner"><i data-lucide="activity" class="w-4 h-4 text-white/60"></i></div>
                    </div>
                    <div class="text-center mb-6">
                        <span id="val${s.id}" class="text-5xl font-black tech-font text-white value-glow">--</span>
                        <span class="text-lg text-${s.color}-400/80 tech-font">°C</span>
                    </div>
                    <div class="glass-inner p-2">
                        <canvas id="chart${s.id}"></canvas>
                    </div>
                </div>
            `;
        });
        lucide.createIcons();

        let stateAC1 = false;
        let stateAC2 = false;
        let bleCharacteristic;
        let bluetoothDevice;

        function updateClock() {
            const now = new Date();
            const d = document.getElementById('dateDisplay');
            const t = document.getElementById('timeDisplay');
            if(d) d.textContent = now.toLocaleDateString('es-ES', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });
            if(t) t.textContent = now.toLocaleTimeString('es-ES', { hour12: false });
        }
        setInterval(updateClock, 1000);

        const charts = {};
        function createChart(ctx, color) {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(20).fill(''),
                    datasets: [{
                        data: Array(20).fill(null),
                        borderColor: color,
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4,
                        fill: true,
                        backgroundColor: (context) => {
                            const gradient = context.chart.ctx.createLinearGradient(0, 0, 0, 100);
                            gradient.addColorStop(0, color + '33');
                            gradient.addColorStop(1, 'transparent');
                            return gradient;
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { display: false }, y: { display: false } }
                }
            });
        }

        window.onload = () => {
            sensors.forEach(s => {
                const ctx = document.getElementById(`chart${s.id}`).getContext('2d');
                charts[s.id] = createChart(ctx, s.color === 'blue' ? '#00d2ff' : '#ff0055');
            });
            const ctxAvg = document.getElementById('chartAvg').getContext('2d');
            charts['Avg'] = createChart(ctxAvg, '#39ff14');
            updateClock();
        };

        function updateChartData(id, value) {
            const chart = charts[id];
            if(!chart) return;
            chart.data.datasets[0].data.push(value);
            chart.data.datasets[0].data.shift();
            chart.update('none');
        }

        const serviceUuid = "4fafc201-1fb5-459e-8fcc-c5c9c331914b";
        const characteristicUuid = "beb5483e-36e1-4688-b7f5-ea07361b26a8";

        async function toggleConnection() {
            if (bluetoothDevice && bluetoothDevice.gatt.connected) {
                bluetoothDevice.gatt.disconnect();
            } else {
                try {
                    document.getElementById('btnText').innerText = "VINCULANDO...";
                    bluetoothDevice = await navigator.bluetooth.requestDevice({
                        filters: [{ name: 'TUVN_Termometros' }],
                        optionalServices: [serviceUuid]
                    });
                    
                    bluetoothDevice.addEventListener('gattserverdisconnected', onDisconnected);
                    const server = await bluetoothDevice.gatt.connect();
                    const service = await server.getPrimaryService(serviceUuid);
                    bleCharacteristic = await service.getCharacteristic(characteristicUuid);
                    
                    await bleCharacteristic.startNotifications();
                    bleCharacteristic.addEventListener('characteristicvaluechanged', (e) => {
                        const decoder = new TextDecoder('utf-8');
                        const data = JSON.parse(decoder.decode(e.target.value));
                        let sum = 0; let count = 0;
                        [1,2,3,4].forEach(i => {
                            const val = data[`s${i}`];
                            if(val !== undefined) {
                                document.getElementById(`val${i}`).innerText = val.toFixed(1);
                                updateChartData(i, val);
                                sum += val; count++;
                            }
                        });
                        if(count > 0) {
                            const average = data.avg || (sum / count);
                            document.getElementById('valAvg').innerText = average.toFixed(1);
                            updateChartData('Avg', average);
                            updateThermalUI(average);
                        }
                        document.getElementById('staticDot').classList.add('animate-pulse');
                    });

                    document.getElementById('statusText').innerText = "ONLINE";
                    document.getElementById('statusText').className = "text-[9px] font-bold tech-font text-emerald-500";
                    document.getElementById('staticDot').className = "h-2 w-2 rounded-full bg-emerald-500 shadow-[0_0_8px_#10b981]";
                    document.getElementById('btnText').innerText = "DESCONECTAR";
                } catch (error) {
                    console.log(error);
                    document.getElementById('btnText').innerText = "INICIAR PROTOCOLO";
                }
            }
        }

        function onDisconnected() {
            document.getElementById('statusText').innerText = "OFFLINE";
            document.getElementById('statusText').className = "text-[9px] font-bold tech-font text-red-500";
            document.getElementById('staticDot').className = "h-2 w-2 rounded-full bg-red-600";
            document.getElementById('staticDot').classList.remove('animate-pulse');
            document.getElementById('btnText').innerText = "INICIAR PROTOCOLO";
        }

        async function sendCommand(cmd) {
            if (currentUser !== 'ADMINISTRADOR' || !bleCharacteristic) return;
            try {
                const encoder = new TextEncoder();
                await bleCharacteristic.writeValue(encoder.encode(cmd));
                if(cmd === 'AC1') {
                    stateAC1 = !stateAC1;
                    updateActuatorUI('AC1', stateAC1);
                } else if(cmd === 'AC2') {
                    stateAC2 = !stateAC2;
                    updateActuatorUI('AC2', stateAC2);
                }
            } catch (e) { console.log(e); }
        }

        function updateActuatorUI(id, state) {
            const btn = document.getElementById(`btn${id}`);
            const icon = document.getElementById(`icon${id}`);
            const status = document.getElementById(`status${id}`);
            if(state) {
                btn.classList.add('bg-blue-500/20', 'border-blue-500');
                icon.classList.replace('text-slate-400', 'text-blue-400');
                if(id === 'AC1') icon.classList.add('animate-spin');
                status.innerText = "RUNNING";
                status.classList.replace('text-slate-500', 'text-blue-400');
            } else {
                btn.classList.remove('bg-blue-500/20', 'border-blue-500');
                icon.classList.replace('text-blue-400', 'text-slate-400');
                icon.classList.remove('animate-spin');
                status.innerText = "OFF";
                status.classList.replace('text-blue-400', 'text-slate-500');
            }
        }

        function updateThermalUI(avg) {
            const fill = document.getElementById('thermalFill');
            const percentage = Math.min(100, Math.max(0, (avg / 50) * 100));
            fill.style.height = percentage + '%';
            if(avg > 30) fill.style.background = 'var(--neon-red)';
            else if(avg > 20) fill.style.background = 'var(--neon-green)';
            else fill.style.background = 'var(--neon-blue)';
        }
    </script>
</body>
</html>
